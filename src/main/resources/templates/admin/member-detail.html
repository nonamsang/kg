<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="ko">

<head>
	<meta charset="UTF-8">
	<title>회원 상세</title>

	<!-- CSRF (AJAX 필요 시) -->
	<meta name="_csrf" th:content="${_csrf.token}">
	<meta name="_csrf_header" th:content="${_csrf.headerName}">

	<link rel="stylesheet" th:href="@{/css/admin-member-detail.css}">
</head>


<body th:replace="~{admin/layout :: layout(~{::section}, ~{::#page-scripts})}">
	<section class="member-detail">
		<div class="bg-hero">
			<svg class="hero-svg" viewBox="0 0 800 600" preserveAspectRatio="xMidYMid slice" aria-hidden="true">
				<defs>
					<linearGradient id="g1" x1="0" y1="0" x2="1" y2="1">
						<stop offset="0%" stop-color="#e7f5e6" />
						<stop offset="100%" stop-color="#dff3e4" />
					</linearGradient>
				</defs>
				<rect x="0" y="0" width="800" height="600" fill="url(#g1)" />
				<circle cx="560" cy="140" r="120" fill="#d3ead6" />
				<rect x="80" y="470" width="640" height="8" rx="4" fill="#b7d8bf" />
				<rect x="260" y="330" width="220" height="120" rx="12" fill="#cfe6d3" stroke="#a6ccb0" />
				<rect x="285" y="350" width="170" height="80" rx="8" fill="#eaf5ec" />
				<rect x="240" y="450" width="260" height="22" rx="10" fill="#cfe6d3" stroke="#a6ccb0" />
				<circle cx="160" cy="160" r="36" fill="#cfe6d3" opacity=".7" />
				<circle cx="190" cy="210" r="18" fill="#cfe6d3" opacity=".6" />
			</svg>

			<div class="hero-inner">
				<div class="modal-card">
					<button class="close" type="button" th:onclick="|location.href='@{/admin/members}'|">✕</button>
					<h2 class="title">사용자 정보 수정</h2>

					<div class="profile-head">
						<div class="avatar">
							<img th:if="${u.profile_Photo}" th:src="${u.profile_Photo}" alt="avatar">
							<div class="placeholder"
								th:if="${u.profile_Photo == null || #strings.isEmpty(u.profile_Photo)}"></div>
						</div>
						<!--<div class="nick" th:text="${u.name != null && u.name != '' ? u.name : u.nickname}">name</div>-->
					</div>

					<hr class="divider" />

					<form th:action="@{|/admin/members/${u.id}|}" method="post" class="form-grid">

						<label>이름</label> <input type="text" name="name" th:value="${u.name}" required>
						<!--<label>아이디</label> <input type="text" th:value="${u.id}" disabled>-->
						<label>OAuth ID</label> <input type="text" th:value="${u.oauth_Id}" disabled>
						<label>가입일</label> <input type="text"
							th:value="${#dates.format(u.created_At, 'yyyy-MM-dd')}" disabled>

						<label>닉네임</label> <input type="text" name="nickname" th:value="${u.nickname}">
						<label>주소</label> <input type="text" name="address" th:value="${u.address}">
						<label>배지</label> <input type="text" name="badge" th:value="${u.badge}">
						<label>포인트</label> <input type="number" name="point" th:value="${u.point}">

						<label>그룹(역할)</label>
						<div class="role-wrap">
							<label class="chk" th:classappend="${u.role=='admin'} ? ' active-role'">
								<input type="checkbox" name="role" value="admin" th:checked="${u.role=='admin'}"
									disabled>
								관리자
							</label>
							<label class="chk" th:classappend="${u.role=='user'} ? ' active-role'">
								<input type="checkbox" checked disabled> 사용자
							</label>
							<input type="hidden" id="roleHidden" name="role" th:value="${u.role}">
						</div>


						<label>프로필 사진 URL</label>
						<div class="photo-row">
							<input type="text" name="profile_Photo" th:value="${u.profile_Photo}"
								placeholder="https://...">
							<button class="btn ghost" type="button"
								onclick="const i=this.previousElementSibling; const img=document.querySelector('.avatar img'); if(img){img.src=i.value||'';}">미리보기</button>
						</div>

						<div class="actions">
							<a th:href="@{/admin/members}" class="btn">취소</a>
							<button type="submit" class="btn primary">확인</button>
						</div>
					</form>
				</div>
			</div>
		</div>
		<th:block id="page-scripts"></th:block>
	</section>
</body>

</html>