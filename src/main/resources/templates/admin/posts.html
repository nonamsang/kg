<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="ko">

<head>
	<meta charset="UTF-8">
	<title th:text="${title} ?: '게시판관리'"></title>
	<link rel="stylesheet" th:href="@{/css/admin.css}">
</head>

<body th:replace="~{admin/layout :: layout(~{::section}, ~{::#page-scripts})}">
	<section>
		<h2>게시판관리</h2>

		<form method="get" class="filter">
			<input type="text" name="keyword" th:value="${q.keyword}" placeholder="제목 검색">
			<button type="submit">검색</button>
		</form>

		<div class="table-wrap">
			<table class="list">
				<thead>
					<tr>
						<th>ID</th>
						<th>분류</th>
						<th>제목</th>
						<th>좋아요</th>
						<th>작성일</th>
						<th>관리</th>
					</tr>
				</thead>
				<tbody>
					<tr th:each="p : ${res.rows}" class="clickable"
						th:onclick="|location.href='@{/admin/posts/{id}(id=${p['id']})}'|" style="cursor:pointer">
						<td th:text="${p['id']}"></td>
						<td th:text="${p['type']}"></td>
						<td th:text="${p['title']}"></td>
						<td th:text="${p['likes']}"></td>
						<td th:text="${#dates.format(p['created_at'], 'yyyy-MM-dd HH:mm')}"></td>
						<td>
							<button type="button" class="btn btn-danger btn-sm" th:attr="data-id=${p['id']}"
								onclick="event.stopImmediatePropagation(); deletePostAxios(this)">삭제</button>
						</td>
					</tr>
				</tbody>
			</table>
		</div>

		<div id="app-confirm" class="modal" aria-hidden="true">
			<div class="modal__panel" role="dialog" aria-modal="true" aria-labelledby="app-confirm-msg">
				<p id="app-confirm-msg">삭제하시겠습니까?</p>
				<div class="modal__actions">
					<button type="button" id="app-confirm-ok" class="btn btn-danger">확인</button>
					<button type="button" id="app-confirm-cancel" class="btn btn-ghost">취소</button>
				</div>
			</div>
		</div>

		<!-- 페이지 스크립트 묶음 -->
		<th:block id="page-scripts">
			<script th:src="@{/js/admin-posts.js(v=${#dates.createNow().time})}"></script>
		</th:block>
	</section>
</body>

</html>