<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="ko">
<head>
  <meta charset="UTF-8">
  <title>탄소중립포인트 조회 (DEMO)</title>
  <link rel="stylesheet" href="/css/style.css"> <!-- 공통 스타일 -->
  <link rel="stylesheet" href="/css/carbonpoint.css"> <!-- 탄소중립포인트 전용 스타일 -->
</head>
<body>
  <div th:replace="fragments/header :: header"></div>

  <div class="wrap">
    <h2>탄소중립포인트 조회 (DEMO)</h2>
    <p class="muted">
      이 화면은 <strong>DEMO(개발) 환경</strong> 예제
    </p>

    <!-- 입력 폼 -->
    <form class="card" th:action="@{/carbon/netzero}" method="post" th:object="${form}">
<!--     <form class="card" th:action="@{/carbonpoint/run}" method="get" th:object="${form}">  -->
      <div class="grid">
        <div>
          <label>기관코드 (고정: 0002)</label>
          <input type="text" th:field="*{organization}" readonly>
        </div>
        <div>
          <label>조회 연도 (선택: 미입력 시 최근연도)</label>
          <input type="text" th:field="*{year}" placeholder="예: 2025">
        </div>

        <div>
          <label>탄소중립포인트 로그인 아이디</label>
          <input type="text" th:field="*{userId}" placeholder="예: your_login_id" required>
        </div>
        <div>
          <label>탄소중립포인트 로그인 비밀번호</label>
          <input type="password" th:field="*{password}" placeholder="비밀번호" required>
        </div>
      </div>

      <div style="margin-top:12px">
        <button class="btn" type="submit">조회하기</button>
      </div>
    </form>




    <!-- 결과 -->
    <div class="card" th:if="${success != null}">
      <div th:if="${success}" class="ok">조회 성공</div>
      <div th:if="${!success}" class="error" th:text="'조회 실패: ' + ${errorMessage}"></div>
    </div>

    <div class="card" th:if="${success}">
      <h3>요약</h3>
      <table>
        <tbody>
        <tr><th>이름</th><td th:text="${result.resName}">-</td></tr>
        <tr><th>등급</th><td th:text="${result.resRating}">-</td></tr>
        <tr><th>실천건수(연간)</th><td th:text="${result.resCount}">-</td></tr>
        <tr><th>적립포인트(연간)</th><td th:text="${result.resEarnPoint}">-</td></tr>
        <tr><th>지급포인트(연간)</th><td th:text="${result.resGivePoint}">-</td></tr>
        <tr><th>잔여포인트</th><td th:text="${result.resAvailablePoint}">-</td></tr>
        </tbody>
      </table>
    </div>

    <div class="card" th:if="${success}">
      <h3>월별 포인트 현황</h3>
      <table>
        <thead>
        <tr>
          <th>년월</th><th>실적건수</th><th>적립포인트</th><th>지급예정</th><th>지급</th><th>잔여</th><th>지급완료일</th>
        </tr>
        </thead>
        <tbody>
        <tr th:each="m : ${result.resPointList}">
          <td th:text="${m.resYearMonth}">202501</td>
          <td th:text="${m.resCount}">0</td>
          <td th:text="${m.resEarnPoint}">0</td>
          <td th:text="${m.resGivePlanPoint}">0</td>
          <td th:text="${m.resGivePoint}">0</td>
          <td th:text="${m.resAvailablePoint}">0</td>
          <td th:text="${m.resPaymentDate}">-</td>
        </tr>
        </tbody>
      </table>

      <h4 style="margin-top:12px">상세 내역(예: 전자영수증 등)</h4>
      <table>
        <thead>
        <tr>
          <th>년월</th><th>일자</th><th>기업명</th><th>활동</th><th>상세</th><th>건수</th><th>실천포인트</th>
        </tr>
        </thead>
        <tbody>
        <tr th:each="m : ${result.resPointList}">
          <td th:rowspan="${#lists.size(m.resDetailList)}" th:text="${m.resYearMonth}" th:if="${m.resDetailList != null and !m.resDetailList.isEmpty()}">202501</td>
          <td th:each="d, stat : ${m.resDetailList}">
            <span th:text="${d.resDate}">20250101</span>
            <span style="display:none" th:if="${false}"></span>
          </td>
        </tr>
        </tbody>
      </table>
    </div>

    <div class="card" th:if="${success}">
      <h3>실천항목별 포인트 현황</h3>
      <table>
        <thead>
        <tr>
          <th>항목</th><th>건수</th><th>상세실적</th><th>적립포인트</th>
        </tr>
        </thead>
        <tbody>
        <tr th:each="t : ${result.resPointList1}">
          <td th:text="${t.resType}">전자영수증</td>
          <td th:text="${t.resCount}">0</td>
          <td th:text="${t.resPerformance}">-</td>
          <td th:text="${t.resEarnPoint}">0</td>
        </tr>
        </tbody>
      </table>
    </div>
  </div>

  <div th:replace="fragments/footer :: footer"></div>
</body>
</html>
